"use strict";var e=require("../../common/vendor.js"),t=require("../../utils/request.js");const a={data:()=>({login:!1,sort:!0,src:""}),onLoad(e){},methods:{logins(e){this.login=!0,this.sort=e},takePhoto(){e.index.createCameraContext().takePhoto({quality:"high"}).then((a=>{this.src=a.tempImagePath,console.log("拍照"),t.uploadFile({url:"/face/register",src:a.tempImagePath}).then((t=>{switch(JSON.parse(t.data).data.msg){case"用户已存在":this.logIn(this.src);break;case"注册成功":e.index.setStorageSync("Authorization",t.header.Authorization),e.index.setStorageSync("user",JSON.parse(t.data).data.user),e.index.reLaunch({url:"../index/index?login=true&tab_id=2"}),e.index.showToast({title:"登录成功",duration:2e3});break;default:e.index.showToast({title:"登录失败",duration:2e3})}e.index.setStorageSync("Authorization",t.header.Authorization)}))}))},logIn(a){console.log(a),t.uploadFile({url:"/face/login",src:a}).then((t=>{if(console.log(JSON.parse(t.data),t),"登录成功"===JSON.parse(t.data).data.msg)e.index.setStorageSync("Authorization",t.header.Authorization),e.index.setStorageSync("user",JSON.parse(t.data).data.user),e.index.reLaunch({url:"../index/index?login=true&tab_id=2"}),e.index.showToast({title:"登录成功",duration:2e3});else e.index.showToast({title:"登录失败",duration:2e3})}))},changepiliang(){this.piliang=!this.piliang}}};var o=e._export_sfc(a,[["render",function(t,a,o,i,n,r){return e.e({a:!n.login},n.login?{}:{b:e.o((e=>r.logins(!0)))},{c:n.login},n.login?{d:this.qianhou,e:e.o(((...e)=>t.error&&t.error(...e))),f:e.o(((...e)=>r.takePhoto&&r.takePhoto(...e))),g:e.o(((...e)=>t.changeqianhou&&t.changeqianhou(...e)))}:{})}]]);wx.createPage(o);
